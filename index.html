<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Music Game</title>
    <style>
        body { font-family: sans-serif; background: #121212; color: white; text-align: center; padding: 20px; }
        .card { background: #1e1e1e; padding: 25px; border-radius: 15px; max-width: 400px; margin: auto; border: 1px solid #333; }
        button { background: #ff2d55; border: none; padding: 12px 25px; color: white; border-radius: 20px; font-weight: bold; cursor: pointer; margin: 10px; }
        .hidden { display: none; }
        .score-board { font-size: 14px; margin-top: 20px; color: #888; }
        #debug { font-size: 10px; color: #444; margin-top: 10px; }
    </style>
</head>
<body>

<div class="card">
    <div id="setup">
        <h2>Register Players</h2>
        <input type="text" id="nameIn" placeholder="Name" style="padding:10px; border-radius:5px; border:none;">
        <button onclick="addP()">Add</button>
        <div id="pList" style="margin:10px;"></div>
        <button id="startBtn" class="hidden" onclick="startGame()">Start Game</button>
    </div>

    <div id="game" class="hidden">
        <h3 id="turnTxt"></h3>
        <p style="font-size: 12px; color: #888;">Make sure your volume is UP</p>
        
        <button id="mainBtn" onclick="handleMusic()">üîä Play New Song</button>
        
        <div id="controls" class="hidden">
            <audio id="player" controls style="width: 100%; filter: invert(1); margin-bottom: 10px;"></audio>
            <button onclick="reveal()" id="revBtn" style="background:#444;">Show Details</button>
            
            <div id="results" class="hidden" style="background:#282828; padding:15px; border-radius:10px;">
                <h2 id="songN" style="margin:0;"></h2>
                <p id="songA" style="color:#ff2d55;"></p>
                <h1 id="songY"></h1>
                <p>2+ Correct?</p>
                <button onclick="endTurn(true)">‚úÖ Yes</button>
                <button onclick="endTurn(false)" style="background:#444;">‚ùå No</button>
            </div>
        </div>

        <div class="score-board" id="sb"></div>
    </div>
</div>

<script>
    let players = [];
    let cur = 0;
    const playlist = [
        { n: "Flowers", a: "Miley Cyrus", y: 2023, u: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" }, // Generic test link 1
        { n: "Blinding Lights", a: "The Weeknd", y: 2019, u: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3" }, // Generic test link 2
        { n: "Stayin' Alive", a: "Bee Gees", y: 1977, u: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3" }
    ];

    function addP() {
        const val = document.getElementById('nameIn').value;
        if(val) { players.push({name: val, score: 0}); document.getElementById('nameIn').value=''; renderP(); }
    }
    function renderP() {
        document.getElementById('pList').innerText = players.map(p => p.name).join(', ');
        if(players.length > 0) document.getElementById('startBtn').classList.remove('hidden');
    }
    function startGame() {
        document.getElementById('setup').classList.add('hidden');
        document.getElementById('game').classList.remove('hidden');
        updateUI();
    }
    function updateUI() {
        document.getElementById('turnTxt').innerText = players[cur].name + "'s Turn";
        document.getElementById('sb').innerText = players.map(p => p.name + ": " + p.score).join(' | ');
    }
    
    function handleMusic() {
        const p = document.getElementById('player');
        const s = playlist[Math.floor(Math.random() * playlist.length)];
        window.activeS = s;
        
        p.src = s.u;
        p.play(); // Triggered by user click
        
        document.getElementById('mainBtn').classList.add('hidden');
        document.getElementById('controls').classList.remove('hidden');
        document.getElementById('results').classList.add('hidden');
        document.getElementById('revBtn').classList.remove('hidden');
    }

    function reveal() {
        document.getElementById('songN').innerText = window.activeS.n;
        document.getElementById('songA').innerText = window.activeS.a;
        document.getElementById('songY').innerText = window.activeS.y;
        document.getElementById('results').classList.remove('hidden');
        document.getElementById('revBtn').classList.add('hidden');
    }

    function endTurn(win) {
        if(win) players[cur].score++;
        if(players[cur].score >= 10) { alert(players[cur].name + " wins!"); location.reload(); }
        cur = (cur + 1) % players.length;
        document.getElementById('controls').classList.add('hidden');
        document.getElementById('mainBtn').classList.remove('hidden');
        updateUI();
    }
</script>
</body>
</html>
